
{% extends "page.basic.html" %}
{% from 'macros/navmenu.html' import navmenu, hxltable %}

{% set nav_validate='active' %}

{% block menu %}
{{ navmenu(profile, key=key, facet='validate') }}
{% endblock %}

{% block title %}HXL Proxy: Validate it{% endblock %}

{% block main %}
    <h1>
      Validate:
      {% if key %}
      <cite>{{ profile.name }}</cite>
      {% else %}
      HXL data
      {% endif %}
    </h1>

      {% if profile.args.url %}
      {% if errors %}
      <div class="panel panel-error">
        <div class="panel-heading">
          <h2>Validation errors.</h2>
        </div>
        <div class="panel-body">
          <p>Failed</p>
        </div>
      </div>
      {% else %}
      <div class="panel panel-success">
        <div class="panel-heading">
          <h2 class="panel-title">Success!</h2>
        </div>
        <div class="panel-body">
          <p>
            The HXL dataset
            {% if key %}
            <cite><a href="/data/{{ key }}">{{ profile.name}}</a></cite>
            {% else %}
            {% endif %} 
            has no validation errors or warnings with 
            {% if profile.args.schema_url %}
            <a href="{{ profile.args.schema_url }}">custom schema</a>
            {% else %}
            the default schema{% endif %}.
          </p>

          <p><a class="btn btn-default" data-toggle="modal" data-target="#customise">Customise</a></p>

        </div>
      </div>
      {% endif %}
      {% endif %}

      <div class="modal fade" id="customise" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h2 class="modal-title">Customise validation</h2>
            </div>
            <div class="modal-body">
              <form class="form" action="">

                {% if not key %}
                <div class="form-group required">
                  <label class="control-label">HXL dataset URL</label>
                  <input class="form-control" name="url" type="url" required="required" value="{{ profile.args.url or '' }}"
                         placeholder="http://example.org/my-hxl-data.csv" />
                </div>
                {% endif %}

                <div class="form-group">
                  <label for="schema_url">Custom HXL schema URL</label>
                  <input name="schema_url" type="url" value="{{ profile.args.schema_url or '' }}" class="form-control"
                         placeholder="http://example.org/my-hxl-schema.csv" />
                  <p class="help-block">You can choose a custom schema with special rules for your dataset.</p>
                </div>

                <button class="btn btn-success" type="submit">Update</button>

              </form>
            </div>
          </div>
        </div>
      </div>

    {% if key %}
    {% include 'snippets/edit-dialog.html' %}
    {% endif %}

{% endblock %}
