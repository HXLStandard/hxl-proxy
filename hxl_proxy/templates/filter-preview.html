<!DOCTYPE html>
<html>
  <head>
    <title>{{ title|default('Filtered HXL data') }}</title>
    <link rel="stylesheet" type="text/css" href="{{ static('style.css') }}" />
  </head>
  <body>
    <ul class="breadcrumbs">
      <li><a href="/">HXL Proxy</a></li>
    </ul>
    <h1>{{ title|default('Filtered HXL data') }}</h1>

    {% if key %}
    <p>
      <a href="/data/{{ key }}/chart">Chart</a> |
      <a href="/data/{{ key }}.csv">Download CSV</a> |
      <a href="/data/{{ key }}.json">Download JSON</a> |
      <a href="/data/{{ key }}/edit">Edit filter</a>
   </p>
    {% else %}
    <form method="POST" action="/actions/save-filter">
      {% for name in args %}
      {% if args[name] %}
      <input type="hidden" name="{{ name }}" value="{{ args[name] }}" />
      {% endif %}
      {% endfor %}
      <button type="submit">Save this filter</button>
    </form>
    {% endif %}

    <table>
      <thead>
        {% if source.hasHeaders %}
        <tr class="hxl-headers">
          {% for header in source.headers %}
          <th>{{ unicode(header) }}</th>
          {% endfor %}
        </tr>
        {% endif %}
        <tr class="hxl-tags">
          {% for tag in source.tags %}
          <th>{{ unicode(tag) }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for row in source %}
        <tr>
          {% for value in row.values %}
          <td>{{ unicode(value) }}</td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </body>
</html>
